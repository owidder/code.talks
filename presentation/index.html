<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>D3 in 15 minutes</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <style>
        svg {
            background: white;
        }

        mark.my {
            border-color: white;
            font-weight: bolder;
            background: white;
        }

        span.old {
            opacity: .5;
            font-weight: lighter;
            color: lightgrey;
        }

        circle {
            fill: white;
            stroke: black;
            stroke-width: 2px;
            opacity: .5;
        }

        pre.new {
            background-color: lightgoldenrodyellow;
        }

    </style>

    <link rel="stylesheet" type="text/css" href="../node_modules/materialize-css/dist/css/materialize.css"
          media="screen,projection"/>
    <link rel="stylesheet" type="text/css" href="../css/material-icons.css"/>

    <script src="../node_modules/d3/build/d3.js"></script>
    <script src="../node_modules/lodash/lodash.js"></script>
    <script src="../node_modules/bottlejs/dist/bottle.js"></script>
    <script>const bottle = new Bottle();</script>
    <script src="../node_modules/jquery/dist/jquery.js"></script>
    <script src="../node_modules/js-url/url.js"></script>

    <script src="../js/util/util.js"></script>

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>

<script>
    const util = bottle.container.util;
</script>

<div class="reveal">
    <div class="slides">

<!--
            Daten zu DOM-Elementen hinzufügen
-->

        <section class="title" data-transition="zoom">
            Daten zu DOM-Elementen hinzufügen
        </section>

        <section>
            <pre><code>
            <svg id="svg01" height="600" width="1000">
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
            </svg>
            </code></pre>
            <pre>
                <code data-trim data-noescape>

    const selection = d3.selectAll("circle")
        .data([
            {name:"a", x:100, y:100, r:20, color:"blue"},
            {name:"b", x:100, y:400, r:30, color:"orange"},
            {name:"c", x:600, y:400, r:40, color:"red"}
        ]);

    console.log(document.querySelectorAll("circle"))
                </code>
            </pre>
        </section>
        <section>
            <a onclick="step01()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg01" height="600" width="1000">
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
            </svg>
            <script src="step01.js"></script>
        </section>

<!--
            Attribute der DOM-Elemente ändern<br>
            AKA "Update"
-->

        <section class="title" data-transition="zoom">
            Attribute der DOM-Elemente ändern<br>
            AKA "Update"
        </section>

        <section>
            <pre class="stretch">
                <code data-trim data-noescape>
    <span class="old">const selection = d3.selectAll("circle")
        .data([
            {name: "a", x: 100, y: 100, r: 20, color: "blue"},
            {name: "b", x: 100, y: 400, r: 30, color: "orange"},
            {name: "c", x: 600, y: 400, r: 40, color: "red"}
        ]);</span>

    selection
        .attr("cx", function (d) {
            return d.x;
        })
        .attr("cy", function (d) {
            return d.y;
        })
        .attr("r", function (d) {
            return d.r;
        })
        .style("fill", function (d) {
            return d.color;
        })
                </code>
            </pre>
        </section>
        <section>
            <a onclick="step02()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg02" height="600" width="1000">
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
            </svg>

            <script src="step02.js"></script>
        </section>

<!--
                Transitionen
-->

        <section class="title" data-transition="zoom">
            Transitionen
        </section>

        <section>
            <pre class="stretch">
                <code data-trim data-noescape>
    const selection = d3.selectAll("circle")
        .data([
            {name:"a", x:100, y:100, r:20, color:"blue"},
            {name:"b", x:100, y:400, r:30, color:"orange"},
            {name:"c", x:600, y:400, r:40, color:"red"}
        ]);

    selection
        <mark class="my">.transition()</mark>
        <mark class="my">.duration(5000)</mark>
        .attr("cx", function (d) {
            return d.x;
        })
        .attr("cy", function (d) {
            return d.y;
        })
        .attr("r", function (d) {
            return d.r;
        })
        .style("fill", function (d) {
            return d.color;
        })
                </code>
            </pre>
        </section>

        <section>
            <a onclick="step03()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg03" height="600" width="1000">
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
            </svg>

            <script src="step03.js"></script>
        </section>

<!--
        Daten ändern
-->

        <section class="title" data-transition="zoom">
            Daten ändern
        </section>

        <section>
            <pre class="stretch">
                <code data-trim data-noescape>
    <span class="old">const selection = d3.selectAll("circle")
        .data([
            {name:"a", x:100, y:100, r:20, color:"blue"},
            {name:"b", x:100, y:400, r:30, color:"orange"},
            {name:"c", x:600, y:400, r:40, color:"red"}
        ]);

    selection
        .transition()
        .duration(5000)
        .attr("cx", function (d) {
            return d.x;
        })
        .attr("cy", function (d) {
            return d.y;
        })
        .attr("r", function (d) {
            return d.r;
        })
        .style("fill", function (d) {
            return d.color;
        })</span>

    setTimeout(function () {
        const selection = d3.selectAll("circle")
            .data([
                {name:"c", x:100, y:100, r:80, color:"grey"},
                {name:"a", x:100, y:400, r:10, color:"yellow"},
                {name:"b", x:600, y:400, r:60, color:"cyan"}
            ], function (d) {
                return d.name;
            });

        selection
            .transition()
            .duration(5000)
            .attr("cx", function (d) {
                return d.x;
            })
            .attr("cy", function (d) {
                return d.y;
            })
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return d.color;
            })

    }, 8000);
                </code>
            </pre>
        </section>

        <section>
            <a onclick="step04()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg04" height="600" width="1000">
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
            </svg>

            <script src="step04.js"></script>
        </section>

<!--
        DOM-Elemente erzeugen<br>
        AKA "Enter"
-->

        <section class="title" data-transition="zoom">
            DOM-Elemente erzeugen<br>
            AKA "Enter"
        </section>

        <section>
            <pre class="stretch">
                <code data-trim data-noescape>
    <span class="old">const selection = d3.selectAll("circle")
        .data([
            {name:"a", x:100, y:100, r:20, color:"blue"},
            {name:"b", x:100, y:400, r:30, color:"orange"},
            {name:"c", x:600, y:400, r:40, color:"red"}
        ]);

    selection
        .transition()
        .duration(5000)
        .attr("cx", function (d) {
            return d.x;
        })
        .attr("cy", function (d) {
            return d.y;
        })
        .attr("r", function (d) {
            return d.r;
        })
        .style("fill", function (d) {
            return d.color;
        })</span>

    setTimeout(function () {
        const selection = d3.selectAll("circle")
            .data([
                {name:"c", x:100, y:100, r:80, color:"grey"},
                {name:"a", x:100, y:400, r:10, color:"yellow"},
                <mark class="my">{name:"d", x:600, y:100, r:100, color:"green"},</mark>
                {name:"b", x:600, y:400, r:60, color:"cyan"}
            ], function (d) {
                return d.name;
            });

        <mark class="my">selection.enter()</mark>
            <mark class="my">.append("circle")</mark>
            <mark class="my">.attr("cx", 500)</mark>
            <mark class="my">.attr("cy", 300)</mark>
            <mark class="my">.attr("r", 10);</mark>

        <mark class="my">d3.selectAll("circle")</mark>
            .transition()
            .duration(5000)
            .attr("cx", function (d) {
                return d.x;
            })
            .attr("cy", function (d) {
                return d.y;
            })
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return d.color;
            })

    }, 8000);
                </code>
            </pre>
        </section>

        <section>
            <a onclick="step05()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg05" height="600" width="1000">
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
                <circle cx="500" cy="300" r="10"></circle>
            </svg>

            <script src="step05.js"></script>
        </section>

<!--
        Kleine Anpassung:<br>
        Wir beginnen mit einem leeren SVG-Element
-->

        <section class="title" data-transition="zoom">
            Kleine Anpassung:<br>
            Wir beginnen mit einem leeren SVG-Element
        </section>

        <section>
            <pre><code>
            <svg id="svg01" height="600" width="1000"></svg>
            </code></pre>
        </section>

        <section>
            <pre class="stretch">
                <code data-trim data-noescape>
    <span class="old">const selection = d3.select("svg").selectAll("circle")
        .data([
            {name:"a", x:100, y:100, r:20, color:"blue"},
            {name:"b", x:100, y:600, r:30, color:"orange"},
            {name:"c", x:600, y:600, r:40, color:"red"}
        ]);</span>

    selection.enter()
        .append("circle")
        .attr("cx", 300)
        .attr("cy", 500)
        .attr("r", 5);

    d3.selectAll("circle")
        <span class="old">.transition()
        .duration(5000)
        .attr("cx", function (d) {
            return d.x;
        })
        .attr("cy", function (d) {
            return d.y;
        })
        .attr("r", function (d) {
            return d.r;
        })
        .style("fill", function (d) {
            return d.color;
        })

    setTimeout(function () {
        const selection = d3.select("svg").selectAll("circle")
            .data([
                {name:"c", x:100, y:100, r:80, color:"grey"},
                {name:"a", x:100, y:600, r:10, color:"yellow"},
                {name:"d", x:600, y:100, r:100, color:"green"},
                {name:"b", x:600, y:600, r:60, color:"cyan"}
            ], function (d) {
                return d.name;
            });

        selection.enter()
            .append("circle")
            .attr("cx", 300)
            .attr("cy", 500)
            .attr("r", 5);

        d3.selectAll("circle")
            .transition()
            .duration(5000)
            .attr("cx", function (d) {
                return d.x;
            })
            .attr("cy", function (d) {
                return d.y;
            })
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return d.color;
            })

    }, 8000);</span>

                </code>
            </pre>
        </section>

        <section>
            <a onclick="step06()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg06" height="600" width="1000"></svg>

            <script src="step06.js"></script>
        </section>

<!--
        Zum Schluss (nicht ganz):<br>
        Der exit
-->

        <section class="title" data-transition="zoom">
            Zum Schluss (nicht ganz):<br>
            Der exit
        </section>

        <section>
            <pre class="stretch">
                <code data-trim data-noescape>
    <span class="old">const selection = d3.select("svg").selectAll("circle")
        .data([
            {name:"a", x:100, y:100, r:20, color:"blue"},
            {name:"b", x:100, y:600, r:30, color:"orange"},
            {name:"c", x:600, y:600, r:40, color:"red"}
        ]);

    selection.enter()
        .append("circle")
        .attr("cx", 300)
        .attr("cy", 300)
        .attr("r", 5);

    d3.selectAll("circle")
        .transition()
        .duration(5000)
        .attr("cx", function (d) {
            return d.x;
        })
        .attr("cy", function (d) {
            return d.y;
        })
        .attr("r", function (d) {
            return d.r;
        })
        .style("fill", function (d) {
            return d.color;
        })

    setTimeout(function () {
        const selection = d3.select("svg").selectAll("circle")
            .data([</span>
                {name:"c", x:100, y:100, r:80, color:"grey"},
                {name:"d", x:600, y:100, r:100, color:"green"},
                {name:"b", x:600, y:600, r:60, color:"cyan"}
            <span class="old">], function (d) {
                return d.name;
            });

        selection.enter()
            .append("circle")
            .attr("cx", 300)
            .attr("cy", 300)
            .attr("r", 5);

        d3.selectAll("circle")
            .transition()
            .duration(5000)
            .attr("cx", function (d) {
                return d.x;
            })
            .attr("cy", function (d) {
                return d.y;
            })
            .attr("r", function (d) {
                return d.r;
            })
            .style("fill", function (d) {
                return d.color;
            })</span>

        selection.exit()
            .transition()
            .duration(5000)
            .attr("r", 0)
            .style("opacity", 0)
            .remove();
    <span class="old">}, 8000);</span>

                </code>
            </pre>
        </section>

        <section>
            <a onclick="step07()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg07" height="600" width="1000"></svg>

            <script src="step07.js"></script>
        </section>

<!--
        Und jetzt alles zusammen:<br>
        Select<br>
        Enter<br>
        Update<br>
        Exit<br>
-->

        <section class="title" data-transition="zoom">
            Und jetzt alles zusammen:<br>
            Select<br>
            Enter<br>
            Update<br>
            Exit<br>
        </section>

        <section>
            <a onclick="step08()" class="btn-floating btn-large waves-effect waves-light cyan"><i
                    class="material-icons">play_arrow</i></a>
            <svg id="svg08" height="600" width="1000"></svg>

            <script src="step08.js"></script>
        </section>

    </div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
    // More info about config & dependencies:
    // - https://github.com/hakimel/reveal.js#configuration
    // - https://github.com/hakimel/reveal.js#dependencies
    Reveal.initialize({
        width: window.innerWidth,
        height: window.innerHeight,
        margin: 0,
        transition: 'slide', // default/cube/page/concave/zoom/linear/fade/none
        keyboard: {
            13: function () {
                const slideno = util.getHashParam("s", "0");
                Reveal.slide(slideno);
            }
        },
        dependencies: [
            {src: 'plugin/markdown/marked.js'},
            {src: 'plugin/markdown/markdown.js'},
            {src: 'plugin/notes/notes.js', async: true},
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            }
        ]
    });

    Reveal.addEventListener( 'slidechanged', function( event ) {
        var slideno = event.indexh;
        util.changeHashParam("s", slideno);
    });

</script>
</body>
</html>
